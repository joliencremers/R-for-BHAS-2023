---
title: "Exercises for plots and reports"
output: webexercises::webexercises_default
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(webexercises)
```


## 1. Introduction

The following packages are required for this practical:

```{r, message=FALSE, warning=F}
library(tidyverse) ## This includes ggplot2
library(mice)
library(kableExtra)
library(knitr)
```

## 2. Boys data

### Exercise 2.1 

Create a scatterplot (points) between `age` and `bmi` in the `boys` data set.

`r hide("Hint")`
Use `geom_point` and `aes`
`r unhide()`

`r hide("Answer")`
 
We start by selecting the data we want `boys`, them the geometric representation `geom_point` and then our aestethic mapping `aes(x = age, y = bmi)`
```{r}
boys |> 
  ggplot() + 
  geom_point(aes(x = age,
                 y = bmi))
```

`r unhide()`

### Exercise 2.2 

Add title and labs to the x and y axis

`r hide("Hint")`
Use `ggtitle`, `xlab` and `ylab`
`r unhide()`

```{r, webex.hide="Answer"}
boys |> 
  ggplot() + 
  geom_point(aes(x = age,
                 y = bmi))+
  ggtitle("Plot of the boys dataset") + 
  xlab("Age in years") + 
  ylab("Body Mass Index") 
```

### Exercise 2.3 

Color the lines based on the region the boys are from

`r hide("Hint")`
Use the `color` argument in the `aes` function
`r unhide()`


`r hide("Answer")`
Since we want the color of the lines to be based on the data this is also an aesthetic. So we have to add it inside the `aes`-function.  
The aesthetic that controls the color of the lines is called `color` and the column we want it to descripe is called `reg` so we simply add `color = reg` to the function:
```{r}
boys |> 
  ggplot() + 
  geom_point(aes(x = age,
                 y = bmi,
                 color = reg)) + #<---- Here
  ggtitle("Plot of the boys dataset") + 
  xlab("Age in years") + 
  ylab("Body Mass Index") 
```

`r unhide()`

## 3. Markdown

### Exercise 3.1

Download the RMarkdown-file called "example.Rmd" and inspect it. What does it do?. Try knitting it by pressing the button "Knit" or by pressing the keys Ctrl+Shift+K


`r hide("Answer")`
The file reads the income data that we have looked at earlier. It also generates the dataset `income` which is a tidy dataset that you can use for visualization and calculations.
`r unhide()`

### Exercise 3.2

Add a new section to the markdown file by creating a new header and writing some text. Knit the file when you are done.


`r hide("Answer")`
You can add a new section by writing:
\#\# Some headline

And then any text you write after that will be included in the new section.
Pres Ctrl+Shift+K to Knit
`r unhide()`


### Exercise 3.3

Add a plot of the data to your markdown-file. Perhaps a a barplot showing the number of females in each `workclass`. Remember to decorate your plot with title and labels

`r hide("Answer")`
To create a plot you first create a new code chunk. This is done by pressing Ctrl+Alt+i.  
In the code chunk you can create the by using ggplot. The tricky part here might
be getting the number of females. This can be done by filtering, grouping and summarising the data before
your plot:

```{r eval = F}
income |> 
  filter(sex == 'Female') |> 
  group_by(workclass) |>
  summarise(N_female = n()) |> 
  ggplot() + 
  geom_bar(aes(y = N_female, x = workclass), stat = "identity") + 
  ggtitle("Number of females per workclass") + 
  xlab("workclass") + 
  ylab("Number of females") +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
```

`r unhide()`

### Exercise 3.4

Add a table of your liking, only the sky is the limit!

`r hide("Answer")`
To make a nicer looking table we are going to use the `knitr::kable` and `kableExtra::kable_styling` functions. You can control almost everything with `kable_styling`. 
```{r eval = F}
income |> 
  filter(sex == 'Female') |> 
  group_by(workclass) |>
  summarise(N_female = n()) |> 
  kable()  |> 
  kable_styling()
```

Take a look at the vignette for creating tables in HTML-documents by running the command: browseVignettes("kableExtra") and then click on "Awesome tables in HTML".

`r unhide()`

### Exercise 3.1

Play around with the markdown file and add some new things. Perhaps try to change the output-format by editing the YAML-header if you're adventurous!

*!!This example is only interesting if you want to create PDF instead of HTML!!*   
If you want to create a PDF-document you first have to do some preparation.
Creating PDF's with RMarkdown relies on the typesetting software LaTeX which does not
come installed by default on Windows and can be quite a headache to install manually.  
Thankfully somebody created a package to help us!  

1. First step is installing the packages `tinytex`
```{r eval = F}
install.packages("tinytex")
```

2. Then you need to run the function `tinytex::install_tinytex()`. This download and installs a minimal version of LaTeX to your computer
```{r eval = F}
tinytex::install_tinytex()
```

3. Now you are ready to create PDF documents in RMarkdown!

Edit the YAML in the start of the document so it says:
```{verbatim eval = F}
---
title: "Report for the income data"
output: pdf_document
---
```
Press Knit and voil√°. Hopefully you will generate a nice-looking PDF-document